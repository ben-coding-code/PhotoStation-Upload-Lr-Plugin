__This article applies to V5.2.0 and later. If you intend to use the sync functionality it's strongly recommended to upgrade to this version or later.__
# General remarks
Downloading metadata from Photo Station (PS) to Lightroom (Lr) enables distributed / collaborative editing/maintaining of photo/video metadata via Lr and PS. One typical scenario of such a collaboration is where the photographer maintains and developes his photos in Lr and then publishs them to the PS. Once the photos are in the PS, the family may want to add some tags/keywords or ratings to the photos. Finally, the photographers syncs back all the tags and ratings from the PS to Lr and has an up-to-date view of the wholes family's work. :-)

As with all distributed/collaborative work, there are some questions that have to be answered:
- which metadata items can be synced
- when will they be uploaded
- when will they be downloaded
- what happens if a metadata item is modified in parallel on both sides to different values (e.g. photographer rates a photo 2 stars, family says: 3 stars)
- what happens if someone removes a metadata item

In a nutshell: the general policy of Photo StatLr is:
- Lr is the master of all metadata 
- it allows metadata additions and modifications via the PS, but it prevent metadata removal via the PS

Need more details? Here they come ...

# Supported metadata
The goal of Photo StatLr is to support the two-way synchronization of all photo/video metadata that can be edited in Photo Station 6 plus some of the vital Lr metadata that are currently not supported by the PS, but are translated by Photo StatLr. Here is the list of currently supported items:
- __title__ (single value metadata)
- __description__ (single value metadata)
- __general tags / keywords__ (multiple value metadata)
- __color label__ (translated single value metadata): translated to a PS general tag '+color' (e.g. '+yellow', '+red', etc.)
- __rating__ (translated single value metadata): translated to a PS general tag '*', ..., '*****' --\> will be synced to photo and downloade to the Comments panel
- __comments__ (multiple value metadata): downloaded only to the Comments panel of a published photo in Lr, not snced to the photo itself

The following items are currently not supported:
- person tags (upload is supported via translation of Lr face regions to PS person tags, though)
- geo tags

Note, that you can __only download__ metadata items, that are __also configured for upload__! The reason for that will hopefully become clearer when you've read the whole story.

# When will metadata be uploaded
Metadata upload will be done automatically during photo/video upload. In addition, there are 3 metadata translations that can be configured for each individual Published Collection:
- face regions (not applicable for videos)
- color label
- rating

Every time you publish or export a photo all standard (not configurable) and configured translated metadata will be uploaded. If the photo was re-published, any previous metadata of that photo in the PS will be overwritten.

# When will metadata be downloaded
Metadata download is configurable on a per-item basis for each individual Published Collection. By default, metadata download is disabled for all collections and all metadata items.

Metadata download was integrated into the Lr mechanmis for getting comments and ratings. Thus, it is controlled via the "Publish" button and the "Refresh comments" button in the Comments panel on the right lower corner of Lr in the Library module. Download of metadata will take place:

- For every published photo in the Published Collection each time any photo in the collection is published or re-published immediately after the publish process.
- For every published photo in the Published Collection when the user clicks the 'Refresh Comments' button in the Comments panel.
- After the user adds a new comment to a photo in the Comments panel.

As you can imaging, this approach can be very time-consuming for large Published Collections, so you probably won't enable the download options for those collections permanently, but perhaps only occasionally when you know that there have been changes to photo metadata in the PS.

# Collision handling
Since neither Lr not PS do track the time when a metadata was added, modified or deleted, there is no way to synchronize those changes automatically. There are a few situations where modified metadata may be overwriten:
- When a photo/video is re-published, it will overwrite any metadata in PS for that photo. This means, that if any metadata of a photo was modified via PS between 2 publishings of that photo, these change will be lost. 
- as long as a photo is in state 'To re-publish' there is no download of metadata for this photo from the PS. On one hand, this prevents the overwriting of metadata recently changed in Lr but not yet published with metadata from the PS. On the other hand, when that photo is published the next time, it will overwrite all metadata in PS that were modified in the meantime in PS
- if a photo is published via more than one Published Collection, and you change a metadata of the photo in both places in the PS to different values, one of these change will eventually be overwritten by the other: the last "Refresh Comments" will win.

Two Take-aways:
- Do not start editing metadata in PS as long as photos of that collection are in state 'To be re-published'
- General rule: in any case of collision the status of the metadata of Lr will win.

# What happens if a metadata was removed
- comments can only be removed via PS, when you "'Refresh Comments' in Lr they will be removed in Lr also
- if a (single or multiple value) metadata was removed from a photo in Lr, it will also be removed in the PS when it is re-published 
- if a single value metadata is removed in the PS and metadata for that photo are downloaded to Lr via 'Refresh Comments' the removal will be rejected and the photo changes its state to 'To be re-published', because the photo is no longer in sync with the PS version of the photo. This is you chance to view the logfile for the rejected change and decide whether to remove the metadata also in Lr or not.
- if you remove/add/change a value for multiple value metadata (e.g. general tags/keywords) in the PS, the handling during "Refresh Comments" depends on the count of values in Lr and PS:
	- if there are equal or more values in the PS version of the photo, this will be accepted and synced
	- if there are less values in the PS version of the photo, this will be rejected and the photo changes its state to 'To be re-published' (see above)
	
Well, that's basically it!
	


